#!/bin/bash
#
# DESCRIPTION:
#   Script for running sentiment analysis.
#
# USAGE:
#   ./RUN_ANALYSIS p      runs the preprocessing.
#   ./RUN_ANALYSIS a      runs the analysis.
#   ./RUN_ANALYSIS clean  removes all files generated by this script.
#
# REQUIREMENTS:
#   positive.txt          file containing positive tweets.
#   negative.txt          file containing negative tweets.
#   tweets/files          files containing tweets to be analysed.
#   The preprocessing must be run before the analysis.
#
set -x

if [ $1 -a $1 = "p" ]
then
  python preprocess.py -p positive.txt
  python preprocess.py -n negative.txt
  LINES=`wc -l < positive_preprocessed.txt`
  COUNT=$((LINES-2000))
  split -l $COUNT positive_preprocessed.txt
  mv xaa positive_training.txt
  mv xab positive_test.txt
  LINES=`wc -l < negative_preprocessed.txt`
  COUNT=$((LINES-2000))
  split -l $COUNT negative_preprocessed.txt
  mv xaa negative_training.txt
  mv xab negative_test.txt
set +x
  files=`ls tweets/`
set -x
  for f in $files;
  do
    python preprocess.py -d tweets/$f
  done
fi

if [ $1 -a $1 = "a" ]
then
  python run_sa.py -t -a --evalfiles tweets/*_preprocessed.txt
fi

if [ $1 -a $1 = "clean" ]
then
  rm positive_*
  rm negative_*
  rm tweets/*_preprocessed*
fi
